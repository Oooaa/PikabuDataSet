Пост получился немного не собранным, так что если есть вопросы - отвечу в комментариях!